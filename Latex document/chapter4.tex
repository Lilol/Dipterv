%----------------------------------------------------------------------------
\chapter{Hardware and software environment}\label{chap:Environment}
%----------------------------------------------------------------------------
The primary task of the SOLSUN Traffic Sensor is counting, that is performed by the core software.
However, the entire system requires other supplementary software that facilitate the operation in the production environment, as well as on the target hardware, and provide diagnostic tools for testing and evaluation.
%----------------------------------------------------------------------------
\section{Supplementary software elements}\label{sec:SupplementarySoftware}
%---------------------------------------------------------------------------
The auxiliary software elements' main responsibility is connecting the core to its surroundings.
They provide access to the sensor by transferring the input data (e.g. settings files), from the user to the sensor software, and sending upgrades to the hardware.
These modules are responsible for returning data to the user by managing the EnTalk connection and sending the result of the counting back to the backend system.

The supporting software has various other features.
The configuration tools facilitate the operation under heterogeneous circumstances by providing individual settings for each environment.
Diagnostics tools evaluate the operation and visualize the data stored in the system in various representations.
They are also responsible for the exporting of the result of counting, classification and diagnostics.
%----------------------------------------------------------------------------
\subsection{Configuration process}\label{subs:ProjectConfigurator}
%----------------------------------------------------------------------------
Since the position of the camera and the surrounding environment of the Traffic Sensor are undetermined and varying, the system's properties has to be adaptable to meet the particular requirements.
To be able to calibrate the Traffic Sensor's several parameters in a group, a two-level configuration method has been implemented.
The system's settings are listed in two separate INI files: the settings file and the project file, each of them specifying parameters and their values.

On the first level, the settings file contains basic configuration values, as default parameters for the operation.
Each of these values can be overridden by the projects file's settings if needed, for an environment-specific configuration.

Most of the listed properties are algorithm parameters, for example threshold values for image processing methods.
Other parameters affect the operation by specifying the run mode (discussed further in section \ref{sec:run_modes}.), changing the report frequency, the maximal number of stored timeline columns or deactivating processing steps.
There are strictly environment-specific properties, like the position of the Tripwire on the frame, and the calibration rectangle.
The display and saving of miscellaneous media -- e.g. timeline images, videos and diagnostics files -- can be set as well.

\subsubsection{Manual calibration}
%----------------------------------------------------------------------------
Some environment-specific parameters can be manually configured with a user interface, the Project Configurator.
Using the Project Configurator the position of the Tripwire, the calibration rectangle and optionally the centre of road-lanes can be set up and adjusted, simply by drawing on a frame recorded form the camera, or read from the video file.
Other numeric parameters, like the beginning and ending frame of the video, or the length of the sides of the calibration rectangle can be pre-set as well.

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.5\textwidth]{projectConfigurator.png}
	\caption{The user interface of the Project Configurator. Using the UI several parameters can be set, including the Tripwire (with lilac), the calibration rectangle (with yellow), and other numeric values in text input fields. The Tripwire's beginning and ending point determine the order, in which its points are processed. \label{fig:project_configurator}}
\end{figure}

Besides the configuration tasks, the Project Configurator also communicates with the Sensor through a remote connection.
Software upgrades are sent to the sensor, and the results of counting and other diagnostic files are downloaded from the memory of the hardware using the Configurator's connection.
%----------------------------------------------------------------------------
\subsection{System diagnostics}
%----------------------------------------------------------------------------
The system diagnostics features are responsible for evaluating the precision of the operation and converting information stored in the system into an easily interpretable form.

\subsubsection{Evaluation}
The evaluating is responsible fo calculating the precision of the system.
For measuring the accuracy of the operation, the system was tested on a series of various test videos.

\textbf{Ground truth}
The the correct results of counting are stored in a data set, called the ground truth.
The ground truth is created manually based on an Original Timeline Image of the studied video stream.
%----------------------------------------------------------------------------
\subsubsection{Data representation}
%----------------------------------------------------------------------------
- converting the raw information stored in the system into a form  human interpretation
- meaning the visual

\textbf{Timeline Images}

\textbf{Videos}
%----------------------------------------------------------------------------
\subsection{Operation modes of the Traffic Sensor}
%----------------------------------------------------------------------------
Depending on the particular situation and needs, the Traffic Sensor has two different operation modes.
%----------------------------------------------------------------------------
\subsubsection{Single-run or test mode}\label{sec:run_modes}
First, for testing, development and evaluation purposes the single-run mode is used.
The input video is a file or a video stream from a camera, both with a specified number of frames to be processed.
Since in the single-run mode the process has an exact end, and the length of the procedure is known, it is possible to create GT files in advance, and at the close of the operation, be evaluated.
Post-corrections, like calibration correction are possible as well.
At the end of the procedure other files, such as entire Timeline Images and video files, like the recorded video stream, or a demo video are saved from the data collected throughout the process.
Although most output files are generated at the end of the operation, the reporting of the results of the counting is iterative, the Sensor sends a report file after a time interval -- specified in the configuration files-- has elapsed.

\begin{figure}[!h]
	\centering
	\includesvg[width=\textwidth]{process_run_types}
	\caption{Operation modes o fthe Traffic Sensor. The single-run mode is for testing and development (above), when a video file or a video stream with pre-set amout of frames is processed. The single-run mode has a definite ending, when post-process evaluations and tests are carried out, and entire Timeline Images are be saved. \label{fig:run_types}}
\end{figure}
%----------------------------------------------------------------------------
\subsubsection{Continuous run}
%----------------------------------------------------------------------------
Continuous run is for operation it the production environment.
In the continuous run mode, events are periodic. 
During each period, detection takes place, and the columns of the Timeline Images are collected for saving.
At the end of each iteration, the collected Timeline Image piece are exported, and result of detection and classification is sent as a report.
In this mode evaluation and correction features are not accessible.
%----------------------------------------------------------------------------
\section{Hardware environment}
%----------------------------------------------------------------------------
\subsection{The board}

\subsection{Network architecture}


%----------------------------------------------------------------------------

